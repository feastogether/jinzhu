<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<title>çœŸç  å°ç£ä½³å‘³ âœ¦ æ±‚å¥½é‹</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&family=Noto+Sans+TC:wght@300;400;500&display=swap');
:root{
  --green:#00352c; --green-mid:#2d6b5e; --green-lt:#7bbcad;
  --red:#d90050;   --gold:#c0ab7c;      --gold-lt:#e8d9a8;
  --cream:#fdf8f0; --warm:#f5ede0;      --warm2:#f0e4d0;
  --text:#00352c;  --text2:#4a3a28;     --text3:#9a8870;
  --font-s:'Noto Serif TC',serif; --font-n:'Noto Sans TC',sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;touch-action:manipulation;}
html,body{width:100%;height:100%;overflow:hidden;font-family:var(--font-n);background:var(--cream);}
.page{position:fixed;top:0;left:0;width:100%;height:100%;display:none;overflow:hidden;}
.page.active{display:block;}

/* PRELOADER */
#preloader{position:fixed;inset:0;background:var(--cream);display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999;transition:opacity .8s;}
.pre-logo{width:min(40vw, 160px); height:auto; animation:breath 1.8s ease-in-out infinite;}
@keyframes breath{0%,100%{transform:scale(1);opacity:.85;}50%{transform:scale(1.07);opacity:1;}}
.pre-text{margin-top:14px;font-family:var(--font-s);font-size:.8rem;color:var(--green-mid);letter-spacing:.5em;}

/* OVERLAY */
.overlay{position:fixed;inset:0;background:var(--cream);z-index:5000;pointer-events:none;opacity:0;transition:opacity .3s;}
.overlay.in{opacity:1;pointer-events:all;}

/* SOUND */
#soundBtn{position:fixed;top:14px;right:14px;width:36px;height:36px;background:rgba(255,255,255,.88);border:1px solid #c8e6e0;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:300;font-size:1rem;}

/* â”€â”€ èŠ±ç£šèƒŒæ™¯ â”€â”€ */
.tile-bg{
  position:absolute;inset:0;pointer-events:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Crect width='80' height='80' fill='none'/%3E%3Crect x='1' y='1' width='78' height='78' fill='none' stroke='%232d6b5e' stroke-width='.7' opacity='.14'/%3E%3Cline x1='40' y1='1' x2='40' y2='79' stroke='%232d6b5e' stroke-width='.5' opacity='.1'/%3E%3Cline x1='1' y1='40' x2='79' y2='40' stroke='%232d6b5e' stroke-width='.5' opacity='.1'/%3E%3Cline x1='1' y1='1' x2='79' y2='79' stroke='%232d6b5e' stroke-width='.35' opacity='.08'/%3E%3Cline x1='79' y1='1' x2='1' y2='79' stroke='%232d6b5e' stroke-width='.35' opacity='.08'/%3E%3Cpolygon points='40,22 52,32 58,40 52,48 40,58 28,48 22,40 28,32' fill='none' stroke='%232d6b5e' stroke-width='.7' opacity='.12'/%3E%3Crect x='34' y='34' width='12' height='12' fill='none' stroke='%23c0ab7c' stroke-width='.7' opacity='.18' transform='rotate(45 40 40)'/%3E%3Ccircle cx='1' cy='1' r='4' fill='none' stroke='%23d90050' stroke-width='.5' opacity='.1'/%3E%3Ccircle cx='79' cy='1' r='4' fill='none' stroke='%23d90050' stroke-width='.5' opacity='.1'/%3E%3Ccircle cx='1' cy='79' r='4' fill='none' stroke='%23d90050' stroke-width='.5' opacity='.1'/%3E%3Ccircle cx='79' cy='79' r='4' fill='none' stroke='%23d90050' stroke-width='.5' opacity='.1'/%3E%3C/svg%3E");
  background-size:80px 80px;
}

/* å½©è‰²ç£šæ¢ */
.tile-bar{position:absolute;left:0;right:0;height:9px;}
.tile-bar.top{top:0;background:repeating-linear-gradient(90deg,var(--green) 0 20px,var(--gold) 20px 40px,var(--red) 40px 60px,var(--green) 60px 80px);opacity:.82;}
.tile-bar.bottom{bottom:0;background:repeating-linear-gradient(90deg,var(--red) 0 20px,var(--green) 20px 40px,var(--gold) 40px 60px,var(--red) 60px 80px);opacity:.82;}

/* â”€â”€ COVER â”€â”€ */
#pageCover{background:linear-gradient(160deg,var(--cream) 0%,var(--warm) 100%);}
.cover-inner{position:relative;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;}
.pillar{position:absolute;top:0;bottom:0;width:min(11vw,46px);}
.pillar.left{left:0;}
.pillar.right{right:0;}

/* ä¸»è¦–è¦ºåœ“ç›¤ */
.disk-wrap{position:absolute;top:50%;left:50%;transform:translate(-50%,-54%);width:min(78vw,330px);height:min(78vw,330px);animation:floatDisk 6s ease-in-out infinite;}
@keyframes floatDisk{0%,100%{transform:translate(-50%,-54%);}50%{transform:translate(-50%,-58%);}}

/* æ¨™é¡Œ */
.cover-header{position:absolute;top:5%;left:0;right:0;display:flex;flex-direction:column;align-items:center;z-index:10;}
.cover-logo{width:min(60vw,240px);height:auto;}
.cover-div{display:flex;align-items:center;gap:10px;margin-top:12px;}
.cover-div span{height:1px;width:30px;background:linear-gradient(90deg,transparent,var(--gold),transparent);}
.cover-div em{font-style:normal;color:var(--gold);font-size:.72rem;letter-spacing:.3em;}

/* æŒ‰éˆ• */
.btn-enter-wrap{position:absolute;bottom:9%;left:50%;transform:translateX(-50%);z-index:10;cursor:pointer;}
.btn-enter{
  background:var(--green);color:var(--cream);
  font-family:var(--font-s);font-size:clamp(.95rem,4.2vw,1.15rem);
  font-weight:600;letter-spacing:.4em;padding:14px 44px;
  border-radius:4px;border:none;
  box-shadow:0 4px 0 #001a15,0 6px 18px rgba(0,53,44,.25);
  transition:all .15s;white-space:nowrap;position:relative;overflow:hidden;
}
.btn-enter::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:repeating-linear-gradient(90deg,var(--gold) 0 8px,transparent 8px 16px);}
.btn-enter-wrap:active .btn-enter{transform:translateY(3px);box-shadow:0 1px 0 #001a15;}

/* ç²’å­ */
.petal{position:absolute;pointer-events:none;animation:drift linear infinite;z-index:3;}
@keyframes drift{0%{transform:translateY(-20px) rotate(0);opacity:0;}5%{opacity:.55;}95%{opacity:.1;}100%{transform:translateY(108vh) rotate(540deg);opacity:0;}}

/* é™€èºå„€ */
.perm-dlg{position:fixed;inset:0;background:rgba(0,53,44,.5);backdrop-filter:blur(4px);display:none;align-items:center;justify-content:center;z-index:1000;}
.perm-dlg.show{display:flex;}
.perm-box{background:var(--cream);border-radius:8px;border-top:4px solid var(--red);padding:28px 26px;max-width:290px;text-align:center;box-shadow:0 16px 50px rgba(0,0,0,.2);}
.perm-box h3{font-family:var(--font-s);color:var(--text);font-size:1.05rem;margin-bottom:8px;}
.perm-box p{color:var(--text2);font-size:.86rem;line-height:1.8;margin-bottom:18px;}
.perm-box button{background:var(--green);color:var(--cream);font-family:var(--font-s);font-size:.95rem;font-weight:600;letter-spacing:.2em;padding:10px 28px;border-radius:4px;border:none;cursor:pointer;}

/* â”€â”€ GAME â”€â”€ */
#pageGame{background:var(--warm);}
.game-wrap{position:relative;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;}
.game-top{position:absolute;top:5%;left:0;right:0;display:flex;flex-direction:column;align-items:center;gap:4px;}
.game-logo{width:min(45vw,180px);height:auto;}
.game-title{font-family:var(--font-s);font-size:clamp(.9rem,4vw,1.2rem);color:var(--text);letter-spacing:.2em;font-weight:700;margin-top:4px;}
.shake-tip{position:absolute;top:22%;left:0;right:0;text-align:center;transition:opacity .5s,transform .5s;}
.shake-tip.hidden{opacity:0;transform:translateY(-8px);pointer-events:none;}
.shake-tip p{font-family:var(--font-s);font-size:clamp(.88rem,3.8vw,1.05rem);color:var(--text2);line-height:2.2;letter-spacing:.12em;}
.shake-tip em{font-style:normal;color:var(--green-mid);font-weight:700;}
.shake-can{width:min(38vw,152px);height:min(48vw,192px);cursor:pointer;}
.shake-can.shaking{animation:canShake 2s cubic-bezier(.36,.07,.19,.97);}
@keyframes canShake{
  0%{transform:rotate(0);}5%{transform:rotate(-20deg) translateX(-5px);}10%{transform:rotate(20deg) translateX(5px);}
  15%{transform:rotate(-24deg) translateX(-7px);}20%{transform:rotate(24deg) translateX(7px);}
  30%{transform:rotate(18deg) translateX(5px);}40%{transform:rotate(22deg) translateX(6px);}
  55%{transform:rotate(10deg) translateX(3px);}70%{transform:rotate(-5deg) translateX(-1px);}
  85%{transform:rotate(3deg);}100%{transform:rotate(0);}
}
.tap-hint{text-align:center;margin-top:14px;font-size:clamp(.72rem,2.8vw,.86rem);color:var(--text3);letter-spacing:.2em;animation:blink 2.5s ease-in-out infinite;}
@keyframes blink{0%,100%{opacity:.3;}50%{opacity:.85;}}

/* ç±¤ç«¹é£›å‡º */
#stickOverlay{position:fixed;inset:0;pointer-events:none;z-index:4500;overflow:hidden;display:none;}
#stickOverlay.active{display:block;}
.flying-stick{
  position:absolute;bottom:42%;
  font-family:var(--font-s);font-weight:900;
  writing-mode:vertical-rl;
  background:linear-gradient(180deg,#fffdf5,#f5e8c0);
  border-top:3px solid var(--red);border-left:1.5px solid var(--gold);
  border-right:1.5px solid var(--gold);border-bottom:1.5px solid var(--gold);
  border-radius:3px;padding:10px 7px 14px;
  box-shadow:3px 3px 12px rgba(0,0,0,.2),inset 0 1px 0 rgba(255,255,255,.7);
  letter-spacing:.18em;line-height:1.9;color:var(--text);
  font-size:clamp(15px,4.2vw,22px);opacity:0;
  animation:stickFly var(--dur,1.1s) cubic-bezier(.22,.61,.36,1) var(--delay,0s) forwards;
}
@keyframes stickFly{
  0%{opacity:0;transform:translateY(20px) rotate(var(--r0)) scale(.3);}
  12%{opacity:1;transform:translateY(var(--y1)) rotate(var(--r1)) scale(1.08);}
  55%{opacity:1;transform:translateY(var(--y2)) rotate(var(--r2)) scale(1);}
  85%{opacity:.9;transform:translateY(var(--y3)) rotate(var(--r3)) scale(.98);}
  100%{opacity:0;transform:translateY(var(--y3)) rotate(var(--r3)) scale(.95);}
}

/* â”€â”€ RESULT â”€â”€ */
#pageResult{background:var(--cream);overflow-y:auto;-webkit-overflow-scrolling:touch;}
.result-wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;padding:22px 18px 44px;}
.r-logo-row{display:flex;align-items:center;gap:12px;margin-bottom:14px;}
.r-logo{width:min(40vw,160px);height:auto;}
.r-logo-sep{width:1px;height:32px;background:#c8e6e0;}
.r-logo-label{font-family:var(--font-n);font-size:.66rem;color:var(--text3);letter-spacing:.4em;line-height:1.8;}
.tile-div{width:100%;max-width:380px;height:14px;margin:10px 0;border-radius:3px;opacity:.75;
  background:repeating-linear-gradient(90deg,var(--green) 0 10px,var(--gold) 10px 20px,var(--red) 20px 30px,var(--green) 30px 40px);}
.tile-div-thin{width:100%;max-width:380px;height:7px;margin:8px 0;border-radius:2px;opacity:.5;
  background:repeating-linear-gradient(90deg,var(--gold) 0 8px,var(--green) 8px 16px,var(--gold) 16px 24px);}
.r-title{text-align:center;margin-bottom:12px;}
.r-title h2{font-family:var(--font-s);font-size:clamp(1.3rem,5.5vw,2rem);color:var(--text);font-weight:900;letter-spacing:.25em;}
.r-title p{font-size:.7rem;color:var(--text3);letter-spacing:.4em;margin-top:4px;}

/* ç±¤å¡ */
.f-card{width:100%;max-width:380px;background:var(--cream);border:1.5px solid #c8e6e0;border-radius:6px;overflow:hidden;box-shadow:0 8px 36px rgba(0,53,44,.1);}
.card-tile-band{height:10px;background:repeating-linear-gradient(90deg,var(--green) 0 16px,var(--cream) 16px 18px,var(--red) 18px 34px,var(--cream) 34px 36px,var(--gold) 36px 52px,var(--cream) 52px 54px);}
.card-hd{padding:20px 22px 14px;text-align:center;background:linear-gradient(180deg,rgba(192,171,124,.08) 0%,transparent 100%);border-bottom:1px solid #c8e6e0;}
.card-num{font-family:var(--font-s);font-size:clamp(1.2rem,5vw,1.6rem);font-weight:900;color:var(--text);letter-spacing:.2em;}
.card-badge-row{margin-top:8px;display:flex;align-items:center;justify-content:center;}
.badge{display:inline-flex;align-items:center;padding:5px 20px;border-radius:3px;font-family:var(--font-s);font-size:clamp(.82rem,3.3vw,.96rem);font-weight:700;letter-spacing:.15em;}
.badge-great{background:var(--green);color:var(--cream);}
.badge-good{background:#5a9e6a;color:var(--cream);}
.badge-ok{background:var(--gold);color:var(--text);}
.badge-bad{background:#8a8a8a;color:var(--cream);}
.card-poem{padding:18px 22px;border-bottom:1px solid rgba(0,53,44,.1);text-align:center;background:rgba(192,171,124,.05);}
.poem-line{font-family:var(--font-s);font-size:clamp(.95rem,3.8vw,1.08rem);color:var(--text);line-height:2.4;letter-spacing:.2em;opacity:0;transform:translateY(16px);animation:lineUp .45s ease forwards;}
@keyframes lineUp{to{opacity:1;transform:translateY(0);}}
.card-sects{padding:14px 18px 18px;}
.sect{display:flex;align-items:flex-start;padding:9px 0;border-bottom:1px dashed rgba(0,53,44,.15);opacity:0;transform:translateX(-10px);animation:slideIn .38s ease forwards;}
@keyframes slideIn{to{opacity:1;transform:translateX(0);}}
.sect:last-child{border-bottom:none;}
.sect-tag{flex:0 0 auto;background:var(--green);color:var(--cream);font-size:.7rem;font-weight:600;padding:3px 10px;border-radius:2px;letter-spacing:.1em;margin-right:10px;margin-top:3px;white-space:nowrap;}
.sect-body{color:var(--text2);font-size:clamp(.8rem,3vw,.9rem);line-height:1.9;letter-spacing:.04em;}

.r-btns{display:flex;gap:12px;margin-top:18px;width:100%;max-width:380px;}
.rbtn{flex:1;padding:13px 10px;border-radius:4px;font-family:var(--font-s);font-size:clamp(.82rem,3.3vw,.96rem);font-weight:600;letter-spacing:.2em;cursor:pointer;transition:all .15s;border:none;}
.rbtn:active{transform:translateY(2px);}
.rbtn-out{background:transparent;border:1.5px solid var(--green) !important;color:var(--green);}
.rbtn-fill{background:var(--green);color:var(--cream);box-shadow:0 3px 0 #001a15;}
.rbtn-fill:active{box-shadow:0 1px 0 #001a15;}
.brand-ft{margin-top:18px;text-align:center;color:var(--text3);font-size:.68rem;letter-spacing:.3em;}

/* â”€â”€ PANEL â”€â”€ */
#hTrigger{position:fixed;bottom:0;right:0;width:50px;height:50px;z-index:9990;}
#panel{position:fixed;bottom:-100%;left:0;right:0;max-height:84%;background:var(--cream);border-top:4px solid var(--green);border-radius:16px 16px 0 0;z-index:9995;overflow-y:auto;-webkit-overflow-scrolling:touch;transition:bottom .4s cubic-bezier(.34,1.2,.64,1);padding-bottom:30px;box-shadow:0 -8px 40px rgba(0,53,44,.15);}
#panel.open{bottom:0;}
.ph{display:flex;align-items:center;justify-content:space-between;padding:14px 20px 12px;border-bottom:1px solid #c8e6e0;position:sticky;top:0;background:var(--cream);z-index:1;}
.ph h2{font-family:var(--font-s);font-size:1rem;color:var(--text);letter-spacing:.2em;}
.ph-close{background:none;border:none;color:var(--text3);font-size:1.4rem;cursor:pointer;}
.pb{padding:16px 20px;}
.ps{margin-bottom:20px;}
.ps h3{font-size:.73rem;font-weight:600;color:var(--green-mid);letter-spacing:.3em;text-transform:uppercase;margin-bottom:10px;padding-bottom:5px;border-bottom:1px solid #c8e6e0;}
.cr{margin-bottom:10px;}
.cr label{display:block;font-size:.76rem;color:var(--text3);margin-bottom:4px;}
.cr input,.cr textarea,.cr select{width:100%;border:1.5px solid #c8e6e0;border-radius:6px;padding:8px 12px;color:var(--text);font-family:var(--font-n);font-size:.84rem;outline:none;background:#fff;}
.cr input:focus,.cr textarea:focus{border-color:var(--green);}
.cr textarea{height:70px;resize:vertical;}
.p-btn{width:100%;background:var(--green);color:var(--cream);font-family:var(--font-s);font-size:.95rem;font-weight:600;letter-spacing:.3em;padding:13px;border-radius:4px;border:none;cursor:pointer;box-shadow:0 3px 0 #001a15;margin-top:4px;}
.p-btn:active{transform:translateY(2px);box-shadow:0 1px 0 #001a15;}
.fi{border:1px solid #c8e6e0;border-radius:6px;padding:12px;margin-bottom:10px;}
.fi-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.fi-hd span{font-size:.82rem;color:var(--text);font-weight:600;}
.fi-hd button{background:none;border:none;color:var(--red);cursor:pointer;font-size:1rem;}
</style>
</head>
<body>

<div id="preloader">
  <img src="https://pydlnqriztpzgxbjuohm.supabase.co/storage/v1/object/public/assets/logo_1771308542401.svg?t=1772192672525" class="pre-logo" alt="Logo">
  <div class="pre-text">æ­£åœ¨ç‚ºæ‚¨ç¥ˆç¦ Â· è«‹ç¨å€™</div>
</div>

<div class="overlay" id="overlay"></div>
<button id="soundBtn">ğŸ”Š</button>
<div id="stickOverlay"></div>

<div class="page active" id="pageCover">
  <div class="tile-bg"></div>
  <div class="tile-bar top"></div>
  <div class="tile-bar bottom"></div>

  <div class="pillar left">
    <svg width="100%" height="100%" viewBox="0 0 46 800" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
      <defs><pattern id="plL" x="0" y="0" width="46" height="92" patternUnits="userSpaceOnUse">
        <rect width="46" height="92" fill="#f5ede0"/>
        <rect x="3" y="3" width="40" height="40" fill="none" stroke="#2d6b5e" stroke-width="1.2" opacity=".55"/>
        <line x1="3" y1="23" x2="43" y2="23" stroke="#2d6b5e" stroke-width=".7" opacity=".35"/>
        <line x1="23" y1="3" x2="23" y2="43" stroke="#2d6b5e" stroke-width=".7" opacity=".35"/>
        <circle cx="23" cy="23" r="8" fill="none" stroke="#c0ab7c" stroke-width="1" opacity=".45"/>
        <circle cx="23" cy="23" r="3" fill="#c0ab7c" opacity=".35"/>
      </pattern></defs>
      <rect width="46" height="800" fill="url(#plL)"/>
    </svg>
  </div>
  <div class="pillar right">
    <svg width="100%" height="100%" viewBox="0 0 46 800" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
      <defs><pattern id="plR" x="0" y="0" width="46" height="92" patternUnits="userSpaceOnUse">
        <rect width="46" height="92" fill="#f5ede0"/>
        <rect x="3" y="3" width="40" height="40" fill="none" stroke="#d90050" stroke-width="1.2" opacity=".38"/>
        <line x1="3" y1="23" x2="43" y2="23" stroke="#d90050" stroke-width=".7" opacity=".25"/>
        <line x1="23" y1="3" x2="23" y2="43" stroke="#d90050" stroke-width=".7" opacity=".25"/>
        <circle cx="23" cy="23" r="8" fill="none" stroke="#c0ab7c" stroke-width="1" opacity=".42"/>
      </pattern></defs>
      <rect width="46" height="800" fill="url(#plR)"/>
    </svg>
  </div>

  <div class="disk-wrap" id="lDisk">
    <svg viewBox="0 0 330 330" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
      <circle cx="165" cy="165" r="160" fill="rgba(245,237,224,.88)" stroke="#c0ab7c" stroke-width="2"/>
      <circle cx="165" cy="165" r="152" fill="none" stroke="#2d6b5e" stroke-width=".8" stroke-dasharray="5 6" opacity=".38"/>
      <circle cx="165" cy="165" r="60" fill="rgba(253,248,240,.95)" stroke="#2d6b5e" stroke-width="2"/>
      <rect x="149" y="142" width="32" height="44" rx="4" fill="#2d6b5e" opacity=".85"/>
      <text x="165" y="153" text-anchor="middle" font-size="7" fill="rgba(255,248,220,.82)" font-family="sans-serif">çœŸç </text>
    </svg>
  </div>

  <div class="cover-header">
    <img src="https://pydlnqriztpzgxbjuohm.supabase.co/storage/v1/object/public/assets/logo_1771308542401.svg?t=1772192672525" class="cover-logo" alt="Logo">
    <div class="cover-div">
      <span></span><em id="coverSubtitle">æ±‚å¥½é‹ Â· å•å¤©æ©Ÿ</em><span></span>
    </div>
  </div>

  <div class="btn-enter-wrap" onclick="goToGame()">
    <button class="btn-enter" id="btnEnterText">æ–ä¸€æ–æ±‚ç±¤</button>
  </div>

  <div class="perm-dlg" id="permDialog">
    <div class="perm-box">
      <h3>éœ€è¦é™€èºå„€æ¬Šé™</h3>
      <p>è«‹æˆæ¬Šä½¿ç”¨è¨­å‚™é™€èºå„€ï¼Œé«”é©—è¦–å·®å‹•æ…‹æ•ˆæœã€‚</p>
      <button onclick="requestPerm()">æˆ æ¬Š</button>
    </div>
  </div>
</div>

<div class="page" id="pageGame">
  <div class="tile-bg"></div>
  <div class="tile-bar top"></div>
  <div class="tile-bar bottom"></div>
  <div class="game-wrap">
    <div class="game-top">
      <img src="https://pydlnqriztpzgxbjuohm.supabase.co/storage/v1/object/public/assets/logo_1771308542401.svg?t=1772192672525" class="game-logo" alt="Logo">
      <div class="game-title" id="gameTitle">âœ¦ çœŸç å¥½é‹ç±¤ âœ¦</div>
    </div>
    <div class="shake-tip" id="shakeTip">
      <p><em id="shakeTipText">é»˜å¿µå¿ƒä¸­é¡˜æœ›</em><br>æ–æ™ƒæ‰‹æ©Ÿ æˆ– é»æ“Šç±¤ç­’</p>
    </div>
    <div class="shake-can" id="shakeCan" onclick="doShake()">
      <svg viewBox="0 0 152 192" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
        <g id="sticks" style="opacity:0;transition:opacity .25s;">
          <rect x="64" y="6" width="7" height="82" rx="3.5" fill="#c8904a"/>
          <rect x="76" y="10" width="7" height="78" rx="3.5" fill="#a07030" transform="rotate(11,79,49)"/>
        </g>
        <rect x="42" y="80" width="68" height="104" rx="6" fill="#00352c"/>
        <text x="76" y="117" text-anchor="middle" font-size="13" fill="rgba(192,171,124,.9)" font-family="serif" font-weight="bold" letter-spacing="2">æ±‚</text>
        <text x="76" y="143" text-anchor="middle" font-size="13" fill="rgba(192,171,124,.9)" font-family="serif" font-weight="bold" letter-spacing="2">ç±¤</text>
      </svg>
    </div>
    <div class="tap-hint" id="tapHint">è¼•è§¸ç±¤ç­’ æˆ– æ–æ™ƒæ‰‹æ©Ÿ</div>
  </div>
</div>

<div class="page" id="pageResult">
  <div class="tile-bar top" style="position:fixed;z-index:10;"></div>
  <div class="result-wrap" style="padding-top:20px;">
    <div class="r-logo-row">
      <img src="https://pydlnqriztpzgxbjuohm.supabase.co/storage/v1/object/public/assets/logo_1771308542401.svg?t=1772192672525" class="r-logo" alt="Logo">
      <div class="r-logo-sep"></div>
      <div class="r-logo-label">å°ç£ä½³å‘³<br>å¥½é‹ç±¤è©©</div>
    </div>
    <div class="tile-div"></div>
    <div class="r-title">
      <h2 id="resultTitle">çœŸç å¥½é‹ç±¤</h2>
      <p>JIN Â· ZHU Â· FORTUNE</p>
    </div>
    <div class="tile-div-thin"></div>
    <div class="f-card">
      <div class="card-tile-band"></div>
      <div class="card-hd">
        <div class="card-num" id="cardNum">ç¬¬ä¸€ç±¤</div>
        <div class="card-badge-row"><span class="badge badge-great" id="cardBadge">å¤§å‰</span></div>
      </div>
      <div class="card-poem" id="cardPoem"></div>
      <div class="card-sects" id="cardSects"></div>
    </div>
    <div class="r-btns">
      <button class="rbtn rbtn-out" onclick="goToCover()">å†æ±‚ä¸€ç±¤</button>
      <button class="rbtn rbtn-fill" onclick="saveImg()">å„²å­˜çµæœ</button>
    </div>
    <div class="brand-ft">çœŸç  å°ç£ä½³å‘³ Â· JIN-ZHU Â· Copyright Â© 2026</div>
  </div>
</div>

<div id="hTrigger"></div>
<div id="panel">
  <div class="ph"><h2>âš™ å®¢è£½åŒ–è¨­å®š</h2><button class="ph-close" onclick="closePanel()">âœ•</button></div>
  <div class="pb">
    <div class="ps"><h3>æ–‡å­—è¨­å®š</h3>
      <div class="cr"><label>å°é¢å‰¯æ¨™é¡Œ</label><input type="text" id="cfg-sub" value="æ±‚å¥½é‹ Â· å•å¤©æ©Ÿ"></div>
      <div class="cr"><label>å°é¢æŒ‰éˆ•</label><input type="text" id="cfg-btn" value="æ–ä¸€æ–æ±‚ç±¤"></div>
    </div>
    <button class="p-btn" onclick="applyAll()">âœ… å¥—ç”¨è¨­å®š</button>
  </div>
</div>

<script>
var fortunes=[
  {num:"ç¬¬ä¸€ç±¤",level:"great",badge:"å¤§å‰",
   poem:["å¥½é‹é€£é€£æ˜¥æ„æ¿ƒ","ä½³é¤šç¾å‘³æ—¥æ—¥è±","çœŸç å°å‘³è¿ç¦è‡³","è¬äº‹å¦‚æ„å–œæ°£ç›ˆ"],
   sections:[{label:"ç¸½è«–",text:"æ­¤ç±¤å¤§å‰ï¼Œå¥½é‹æ»¿æº¢ï¼Œè«¸äº‹é †é‚ï¼Œè²¡æºå»£é€²ã€‚"},{label:"äº‹æ¥­",text:"è²´äººç›¸åŠ©ï¼Œäº‹æ¥­è’¸è’¸æ—¥ä¸Šï¼Œå‡é·å¯æœŸã€‚"}]},
  {num:"ç¬¬äºŒç±¤",level:"great",badge:"ä¸Šå‰",
   poem:["å±±çæµ·å‘³å…¥å£ç”˜","å®¶äººå…±èšè©±ç¬‘è«‡","å››å­£å¹³å®‰ç¦å£½é•·","ä¾†å¹´æ›´å‹å¾€å¹´é–“"],
   sections:[{label:"ç¸½è«–",text:"å®¶åº­å’Œæ¨‚ï¼Œè¦ªæƒ…æº«æš–ï¼Œèˆ‡æ‰€æ„›ä¹‹äººå…±åº¦å¥½æ™‚å…‰ã€‚"}]},
  {num:"ç¬¬ä¸‰ç±¤",level:"good",badge:"ä¸­å‰",
   poem:["éœæ°´æµæ·±è‡ªæœ‰æº","å®ˆå¾—é›²é–‹æœˆæ›´åœ“","è¬äº‹è¬€å®šè€Œå¾Œå‹•","æ˜¥æš–èŠ±é–‹åœ¨çœ¼å‰"],
   sections:[{label:"ç¸½è«–",text:"æ™‚æ©Ÿæ¼¸ç†Ÿï¼Œéœå¿ƒç­‰å¾…ï¼Œä¸å®œæ“ä¹‹éæ€¥ã€‚"}]},
  {num:"ç¬¬å››ç±¤",level:"great",badge:"ç¦ç¥¿",
   poem:["é´»ç¦é½Šå¤©å–œäº‹å¤š","ä½³äººå…±åè©±å®¶å¸¸","ç ç‰æ»¿å ‚æ·»å–œè‰²","å¹³å®‰æ˜¯ç¦å‹é»ƒé‡‘"],
   sections:[{label:"ç¸½è«–",text:"ç¦ç¥¿é›™å…¨ï¼Œå®¶æ¥­èˆˆæ—ºï¼Œå–œäº‹é€£é€£ã€‚"}]},
  {num:"ç¬¬äº”ç±¤",level:"ok",badge:"å¹³å®‰",
   poem:["å¹³å¹³å®‰å®‰æ˜¯æœ€çœŸ","æŸ´ç±³æ²¹é¹½æœ‰é¤˜å­˜","çŸ¥è¶³å¸¸æ¨‚å¿ƒè‡ªåœ¨","ä¸€ç²¥ä¸€é£¯çš†æ˜¯æ©"],
   sections:[{label:"ç¸½è«–",text:"å¹³å®‰ç„¡äº‹å³æ˜¯ç¦ï¼ŒçŸ¥è¶³å¸¸æ¨‚ï¼Œè¸å¯¦ç”Ÿæ´»ã€‚"}]}
];
var cur=null,soundOn=true,shakeCount=0,lastA={x:0,y:0,z:0},shakeBlocked=false,tapCount=0,tapTimer=null,audioCtx=null;

window.addEventListener('load',function(){
  setTimeout(function(){ var p=document.getElementById('preloader'); if(p){p.style.opacity='0'; setTimeout(function(){ p.style.display='none'; },800);} },1500);
  createPetals(); initGyro();
  document.getElementById('soundBtn').addEventListener('click',function(){ soundOn=!soundOn; this.textContent=soundOn?'ğŸ”Š':'ğŸ”‡'; });
  document.getElementById('hTrigger').addEventListener('click',function(){
    tapCount++; if(tapTimer)clearTimeout(tapTimer);
    tapTimer=setTimeout(function(){ tapCount=0; },700);
    if(tapCount>=3){ tapCount=0; openPanel(); }
  });
});

function createPetals(){
  var s=['âœ¦','â—†','â–','â–ª','â—‡'],c=document.getElementById('pageCover');
  for(var i=0;i<12;i++){
    var p=document.createElement('div'); p.className='petal'; p.textContent=s[i%s.length];
    p.style.left=(Math.random()*100)+'%'; p.style.fontSize=(Math.random()*8+7)+'px';
    var cols=['rgba(0,53,44,','rgba(192,171,124,','rgba(217,0,80,'];
    p.style.color=cols[i%3]+(Math.random()*.25+.08)+')';
    p.style.animationDuration=(Math.random()*14+12)+'s'; p.style.animationDelay=(Math.random()*12)+'s';
    if(c) c.appendChild(p);
  }
}

function initGyro(){
  if(typeof DeviceOrientationEvent!=='undefined'&&typeof DeviceOrientationEvent.requestPermission==='function'){
    document.getElementById('permDialog').classList.add('show');
  } else if(window.DeviceMotionEvent){ window.addEventListener('devicemotion',handleMotion,false); }
  window.addEventListener('deviceorientation',handleOri,false);
}
function requestPerm(){
  document.getElementById('permDialog').classList.remove('show');
  DeviceMotionEvent.requestPermission().then(function(s){ if(s==='granted'){ window.addEventListener('devicemotion',handleMotion,false); window.addEventListener('deviceorientation',handleOri,false); } }).catch(function(){});
}
function handleMotion(e){
  if(!document.getElementById('pageGame').classList.contains('active')||shakeBlocked) return;
  var a=e.accelerationIncludingGravity; if(!a) return;
  var d=Math.abs(a.x-lastA.x)+Math.abs(a.y-lastA.y)+Math.abs(a.z-lastA.z);
  lastA={x:a.x,y:a.y,z:a.z};
  if(d>14){ shakeCount++; if(shakeCount>=2){ triggerShake(); shakeCount=0; shakeBlocked=true; } }
}
function handleOri(e){
  if(!document.getElementById('pageCover').classList.contains('active')) return;
  var gm=e.gamma||0,bt=e.beta||0,mx=(gm/90)*16,my=(bt/90)*10;
  var d=document.getElementById('lDisk');
  if(d) d.style.transform='translate(-50%,-54%) translate3d('+(mx*.4)+'px,'+(my*.3)+'px,0)';
}

function transition(cb){ var o=document.getElementById('overlay'); o.classList.add('in'); setTimeout(function(){ cb(); o.classList.remove('in'); },300); }
function showPage(id){ document.querySelectorAll('.page').forEach(function(p){ p.classList.remove('active'); }); document.getElementById(id).classList.add('active'); }
function goToGame(){ shakeBlocked=false; transition(function(){ showPage('pageGame'); }); }
function goToCover(){ transition(function(){ showPage('pageCover'); }); }
function goToResult(){ renderResult(cur); transition(function(){ showPage('pageResult'); }); }

function doShake(){ triggerShake(); }
function triggerShake(){
  var can=document.getElementById('shakeCan');
  if(can.classList.contains('shaking')) return;
  document.getElementById('shakeTip').classList.add('hidden');
  can.classList.add('shaking');
  document.getElementById('sticks').style.opacity='1';
  cur=fortunes[Math.floor(Math.random()*fortunes.length)];
  setTimeout(function(){
    can.classList.remove('shaking');
    document.getElementById('sticks').style.opacity='0';
    launchSticks(cur,function(){ goToResult(); });
  },2050);
}

function launchSticks(f,cb){
  var ov=document.getElementById('stickOverlay'); ov.innerHTML=''; ov.classList.add('active');
  var cfg=[
    {left:'8%',r0:'-22deg',y1:'-28vh',r1:'-14deg',y2:'-60vh',r2:'-8deg',y3:'-58vh',r3:'-7deg',dur:'1.15s',delay:'0s'},
    {left:'28%',r0:'-8deg',y1:'-32vh',r1:'-3deg',y2:'-66vh',r2:'-1deg',y3:'-64vh',r3:'-1deg',dur:'1.1s',delay:'0.1s'},
    {left:'50%',r0:'4deg',y1:'-34vh',r1:'1deg',y2:'-68vh',r2:'1deg',y3:'-66vh',r3:'1deg',dur:'1.12s',delay:'0.18s'},
    {left:'68%',r0:'14deg',y1:'-30vh',r1:'8deg',y2:'-62vh',r2:'5deg',y3:'-60vh',r3:'5deg',dur:'1.08s',delay:'0.08s'}
  ];
  for(var i=0;i<4;i++){ (function(idx){
    var c=cfg[idx],el=document.createElement('div'); el.className='flying-stick'; el.textContent=f.poem[idx]||'';
    el.style.left=c.left;
    ['r0','y1','r1','y2','r2','y3','r3','dur','delay'].forEach(function(k){ el.style.setProperty('--'+k,c[k]); });
    ov.appendChild(el);
  })(i); }
  setTimeout(function(){ ov.classList.remove('active'); ov.innerHTML=''; if(cb)cb(); },1700);
}

function renderResult(f){
  document.getElementById('cardNum').textContent=f.num;
  var b=document.getElementById('cardBadge'); b.textContent=f.badge; b.className='badge badge-'+f.level;
  var pe=document.getElementById('cardPoem'); pe.innerHTML='';
  f.poem.forEach(function(l,i){ var p=document.createElement('p'); p.className='poem-line'; p.textContent=l; p.style.animationDelay=(i*.18+.08)+'s'; pe.appendChild(p); });
  var se=document.getElementById('cardSects'); se.innerHTML='';
  f.sections.forEach(function(s,i){ var d=document.createElement('div'); d.className='sect'; d.innerHTML='<span class="sect-tag">'+s.label+'</span><span class="sect-body">'+s.text+'</span>'; d.style.animationDelay=(i*.1+.45)+'s'; se.appendChild(d); });
}

function openPanel(){ document.getElementById('panel').classList.add('open'); }
function closePanel(){ document.getElementById('panel').classList.remove('open'); }
function applyAll(){
  document.getElementById('coverSubtitle').textContent=document.getElementById('cfg-sub').value;
  document.getElementById('btnEnterText').textContent=document.getElementById('cfg-btn').value;
  closePanel();
}
function saveImg(){ alert('è«‹é•·æŒ‰ç•«é¢æˆªåœ–å„²å­˜ç±¤è©©çµæœã€‚'); }
</script>
</body>
</html>
